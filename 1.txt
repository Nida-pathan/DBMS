create database s1;
use s1; 

CREATE TABLE Branch (
    branch_name VARCHAR(50) PRIMARY KEY,
    branch_city VARCHAR(50) NOT NULL,
    assets DECIMAL(12,2) NOT NULL
);

CREATE TABLE Account (
    acc_no INT PRIMARY KEY,
    branch_name VARCHAR(50),
    balance DECIMAL(12,2) NOT NULL,
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer (
    cust_name VARCHAR(50) PRIMARY KEY,
    cust_street VARCHAR(50),
    cust_city VARCHAR(50)
);

CREATE TABLE Depositor (
    cust_name VARCHAR(50),
    acc_no INT,
    PRIMARY KEY (cust_name, acc_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan (
    loan_no INT PRIMARY KEY,
    branch_name VARCHAR(50),
    amount DECIMAL(12,2),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower (
    cust_name VARCHAR(50),
    loan_no INT,
    PRIMARY KEY (cust_name, loan_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (loan_no) REFERENCES Loan(loan_no)
);

-- Insert Sample Data
INSERT INTO Branch VALUES 
('Wadia College', 'Pune', 900000),
('Deccan', 'Pune', 700000),
('Camp', 'Pune', 800000);

INSERT INTO Account VALUES 
(101, 'Wadia College', 25000),
(102, 'Deccan', 30000),
(103, 'Camp', 18000);

INSERT INTO Customer VALUES 
('Anuj', 'MG Road', 'Pune'),
('Riya', 'FC Road', 'Pune'),
('Amit', 'Laxmi Road', 'Pune'),
('Sara', 'JM Road', 'Pune');

INSERT INTO Depositor VALUES 
('Anuj', 101),
('Riya', 102),
('Amit', 103);

INSERT INTO Loan VALUES 
(201, 'Wadia College', 15000),
(202, 'Deccan', 10000),
(203, 'Wadia College', 20000);

INSERT INTO Borrower VALUES 
('Anuj', 201),
('Riya', 202),
('Sara', 203);


SELECT DISTINCT branch_name FROM Loan;


SELECT loan_no FROM Loan
WHERE branch_name = 'Wadia College' AND amount > 12000;

SELECT b.cust_name, l.loan_no, l.amount
FROM Borrower b
JOIN Loan l ON b.loan_no = l.loan_no;


SELECT DISTINCT c.cust_name
FROM Customer c
JOIN Borrower b ON c.cust_name = b.cust_name
JOIN Loan l ON b.loan_no = l.loan_no
WHERE l.branch_name = 'Wadia College'
ORDER BY c.cust_name ASC;


SELECT DISTINCT branch_city FROM Branch;
