create database s2;
use s2;
CREATE TABLE Branch (
    branch_name VARCHAR(50) PRIMARY KEY,
    branch_city VARCHAR(50) NOT NULL,
    assets DECIMAL(12,2) NOT NULL
);

CREATE TABLE Account (
    acc_no INT PRIMARY KEY,
    branch_name VARCHAR(50),
    balance DECIMAL(12,2) NOT NULL,
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer (
    cust_name VARCHAR(50) PRIMARY KEY,
    cust_street VARCHAR(50),
    cust_city VARCHAR(50)
);

CREATE TABLE Depositor (
    cust_name VARCHAR(50),
    acc_no INT,
    PRIMARY KEY (cust_name, acc_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan (
    loan_no INT PRIMARY KEY,
    branch_name VARCHAR(50),
    amount DECIMAL(12,2),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower (
    cust_name VARCHAR(50),
    loan_no INT,
    PRIMARY KEY (cust_name, loan_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (loan_no) REFERENCES Loan(loan_no)
);


INSERT INTO Branch VALUES 
('Wadia College', 'Pune', 900000),
('Deccan', 'Pune', 700000),
('Camp', 'Pune', 800000);

INSERT INTO Account VALUES 
(101, 'Wadia College', 25000),
(102, 'Deccan', 30000),
(103, 'Camp', 18000),
(104, 'Wadia College', 22000);

INSERT INTO Customer VALUES 
('Anuj', 'MG Road', 'Pune'),
('Riya', 'FC Road', 'Pune'),
('Amit', 'Laxmi Road', 'Pune'),
('Sara', 'JM Road', 'Pune'),
('Neha', 'Bund Garden', 'Pune');

INSERT INTO Depositor VALUES 
('Anuj', 101),
('Riya', 102),
('Amit', 103),
('Neha', 104);

INSERT INTO Loan VALUES 
(201, 'Wadia College', 15000),
(202, 'Deccan', 10000),
(203, 'Wadia College', 20000),
(204, 'Camp', 25000);

INSERT INTO Borrower VALUES 
('Anuj', 201),
('Riya', 202),
('Sara', 203);


SELECT DISTINCT d.cust_name
FROM Depositor d
JOIN Borrower b ON d.cust_name = b.cust_name;


SELECT DISTINCT cust_name FROM Depositor
UNION
SELECT DISTINCT cust_name FROM Borrower;


SELECT DISTINCT d.cust_name
FROM Depositor d
WHERE d.cust_name NOT IN (SELECT cust_name FROM Borrower);


SELECT AVG(balance) AS avg_balance
FROM Account
WHERE branch_name = 'Wadia College';


SELECT a.branch_name, COUNT(DISTINCT d.cust_name) AS num_depositors
FROM Depositor d
JOIN Account a ON d.acc_no = a.acc_no
GROUP BY a.branch_name;
