Trigger: Create a row level trigger for the CUSTOMERS table that
would fire INSERT or UPDATE or DELETE operations performed on the
CUSTOMERS table. This trigger will display the salary difference
between the old values and new values.

CREATE TABLE CUSTOMERS (
    Cust_id     NUMBER PRIMARY KEY,
    Cust_name   VARCHAR2(100),
    Salary      NUMBER
);

CREATE TABLE CUSTOMER_AUDIT (
    Audit_id        NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    Cust_id         NUMBER,
    Cust_name       VARCHAR2(100),
    Old_salary      NUMBER,
    New_salary      NUMBER,
    Salary_diff     NUMBER,
    Operation       VARCHAR2(20),
    Audit_time      DATE DEFAULT SYSDATE
);

CREATE OR REPLACE TRIGGER trg_customer_audit
BEFORE INSERT OR UPDATE OR DELETE ON CUSTOMERS
FOR EACH ROW
DECLARE
    sal_diff NUMBER;
BEGIN

    IF INSERTING THEN
        INSERT INTO CUSTOMER_AUDIT (Cust_id, Cust_name, Old_salary, New_salary, Salary_diff, Operation)
        VALUES (:NEW.Cust_id, :NEW.Cust_name, NULL, :NEW.Salary, NULL, 'INSERT');

    ELSIF UPDATING THEN
        sal_diff := :NEW.Salary - :OLD.Salary;
        INSERT INTO CUSTOMER_AUDIT (Cust_id, Cust_name, Old_salary, New_salary, Salary_diff, Operation)
        VALUES (:NEW.Cust_id, :NEW.Cust_name, :OLD.Salary, :NEW.Salary, sal_diff, 'UPDATE');

    ELSIF DELETING THEN
        INSERT INTO CUSTOMER_AUDIT (Cust_id, Cust_name, Old_salary, New_salary, Salary_diff, Operation)
        VALUES (:OLD.Cust_id, :OLD.Cust_name, :OLD.Salary, NULL, NULL, 'DELETE');
    END IF;
END;
/

SET SERVEROUTPUT ON;

INSERT INTO CUSTOMERS VALUES (1, 'Rahul', 40000);
INSERT INTO CUSTOMERS VALUES (2, 'Sneha', 55000);

UPDATE CUSTOMERS SET Salary = 60000 WHERE Cust_id = 1;

DELETE FROM CUSTOMERS WHERE Cust_id = 2;

SELECT * FROM CUSTOMER_AUDIT;
