Write a Stored Procedure namely proc_Grade for the categorization
of student. If marks scored by students in examination is <=1500
and marks>=990 then student will be placed in distinction
category if marks scored are between 989 and 900 category is
first class, if marks 899 and 825 category is Higher Second
Class.
Write a PL/SQL block for using procedure created with above
requirement.
Stud_Marks(name, total_marks),
Result(Roll,Name, Class)



CREATE TABLE Stud_Marks(
  Roll NUMBER PRIMARY KEY,
  Name VARCHAR2(100),
  total_marks NUMBER
);

CREATE TABLE Result(
  Roll NUMBER,
  Name VARCHAR2(100),
  Class VARCHAR2(50)
);

INSERT INTO Stud_Marks VALUES (1, 'Alice', 1000);
INSERT INTO Stud_Marks VALUES (2, 'Bob', 950);
INSERT INTO Stud_Marks VALUES (3, 'Charlie', 850);
INSERT INTO Stud_Marks VALUES (4, 'David', 700);
COMMIT;


CREATE OR REPLACE PROCEDURE proc_Grade (
  p_roll        IN Stud_Marks.Roll%TYPE,
  p_name        IN Stud_Marks.Name%TYPE,
  p_total_marks IN Stud_Marks.total_marks%TYPE
)
IS
  v_class Result.Class%TYPE;
BEGIN
  IF p_total_marks <= 1500 AND p_total_marks >= 990 THEN
    v_class := 'Distinction';
  ELSIF p_total_marks <= 989 AND p_total_marks >= 900 THEN
    v_class := 'First Class';
  ELSIF p_total_marks <= 899 AND p_total_marks >= 825 THEN
    v_class := 'Higher Second Class';
  ELSE
    v_class := 'No Category'; -- Handle other cases
  END IF;

  INSERT INTO Result (Roll, Name, Class)
  VALUES (p_roll, p_name, v_class);
  
EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('Error in proc_Grade: ' || SQLERRM);
END proc_Grade;
/

SET SERVEROUTPUT ON;

DECLARE
  CURSOR c_students IS
    SELECT Roll, Name, total_marks FROM Stud_Marks;
    
BEGIN
  DELETE FROM Result;
  DBMS_OUTPUT.PUT_LINE('Categorizing students...');

  FOR student_rec IN c_students LOOP
    
    proc_Grade(student_rec.Roll, student_rec.Name, student_rec.total_marks);
  END LOOP;
  
  COMMIT;
  DBMS_OUTPUT.PUT_LINE('Student categorization complete.');
  DBMS_OUTPUT.PUT_LINE('Check the Result table to see the output.');

EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('An error occurred: ' || SQLERRM);
    ROLLBACK;
END;
/

SELECT * FROM Result;
