Trigger :Write a after trigger for Insert, update and delete
event considering following requirement:
Emp(Emp_no, Emp_name, Emp_salary)
a) Trigger should be initiated when salary tried to be inserted
is less than Rs.50,000/-
b) Trigger should be initiated when salary tried to be updated
for value less than Rs. 50,000/-
Also the new values expected to be inserted will be stored in new
table Tracking(Emp_no,Emp_salary).


CREATE TABLE Emp (
  Emp_no NUMBER PRIMARY KEY,
  Emp_name VARCHAR2(100),
  Emp_salary NUMBER(10, 2)
);

CREATE TABLE Tracking (
  Emp_no NUMBER,
  Emp_salary NUMBER(10, 2),
  track_date DATE
);

CREATE OR REPLACE TRIGGER trg_emp_salary_check
  AFTER INSERT OR UPDATE OR DELETE ON Emp
  FOR EACH ROW
BEGIN
  
  IF INSERTING THEN
    IF :new.Emp_salary < 50000 THEN
      DBMS_OUTPUT.PUT_LINE(
        'Alert: Employee ' || :new.Emp_no || ' inserted with salary < 50,000 (' || :new.Emp_salary || ')'
      );
    END IF;
    
    INSERT INTO Tracking (Emp_no, Emp_salary, track_date)
    VALUES (:new.Emp_no, :new.Emp_salary, SYSDATE);
    
  ELSIF UPDATING THEN
    IF :new.Emp_salary < 50000 THEN
      DBMS_OUTPUT.PUT_LINE(
        'Alert: Employee ' || :new.Emp_no || ' updated to salary < 50,000 (' || :new.Emp_salary || ')'
      );
    END IF;
   
  ELSIF DELETING THEN
    DBMS_OUTPUT.PUT_LINE('Employee ' || :old.Emp_no || ' deleted.');
  END IF;

EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('Error in trg_emp_salary_check: ' || SQLERRM);
END trg_emp_salary_check;
/

SET SERVEROUTPUT ON;

BEGIN
  DBMS_OUTPUT.PUT_LINE('--- Inserting employee 1 (Salary > 50k) ---');
  INSERT INTO Emp VALUES (1, 'Alice', 60000);
  
  DBMS_OUTPUT.PUT_LINE('--- Inserting employee 2 (Salary < 50k) ---');
  INSERT INTO Emp VALUES (2, 'Bob', 45000);
  
  DBMS_OUTPUT.PUT_LINE('--- Updating employee 1 (Salary still > 50k) ---');
  UPDATE Emp SET Emp_salary = 65000 WHERE Emp_no = 1;
  
  DBMS_OUTPUT.PUT_LINE('--- Updating employee 1 (Salary < 50k) ---');
  UPDATE Emp SET Emp_salary = 48000 WHERE Emp_no = 1;

  DBMS_OUTPUT.PUT_LINE('--- Deleting employee 2 ---');
  DELETE FROM Emp WHERE Emp_no = 2;
  
  COMMIT;
  DBMS_OUTPUT.PUT_LINE('DML operations complete.');
END;
/


SELECT * FROM Emp;
SELECT * FROM Tracking;
